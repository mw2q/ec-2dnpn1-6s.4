BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%floral%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 2735589564.54242
 ALGERIA                   |   1997 |  4668255062.7167
 ALGERIA                   |   1996 | 4688556771.44271
 ALGERIA                   |   1995 | 4659612335.36348
 ALGERIA                   |   1994 | 4673288317.56735
 ALGERIA                   |   1993 | 4647409201.48686
 ALGERIA                   |   1992 |  4688308120.5086
 ARGENTINA                 |   1998 | 2714943854.25276
 ARGENTINA                 |   1997 | 4606116901.04525
 ARGENTINA                 |   1996 | 4641002672.79018
 ARGENTINA                 |   1995 | 4652058246.62056
 ARGENTINA                 |   1994 | 4629738610.32174
 ARGENTINA                 |   1993 | 4626783310.31765
 ARGENTINA                 |   1992 | 4642408738.70239
 BRAZIL                    |   1998 | 2752577189.16137
 BRAZIL                    |   1997 | 4671561790.82646
 BRAZIL                    |   1996 | 4711967888.44734
 BRAZIL                    |   1995 | 4666240831.97532
 BRAZIL                    |   1994 | 4668020551.15757
 BRAZIL                    |   1993 | 4691942257.67514
 BRAZIL                    |   1992 | 4678609564.75106
 CANADA                    |   1998 |  2743910461.8074
 CANADA                    |   1997 | 4671131714.27042
 CANADA                    |   1996 | 4666535558.79689
 CANADA                    |   1995 | 4663193633.33894
 CANADA                    |   1994 | 4660140288.15108
 CANADA                    |   1993 | 4662880182.92308
 CANADA                    |   1992 | 4671611485.70197
 CHINA                     |   1998 | 2720902684.32399
 CHINA                     |   1997 | 4651099109.50975
 CHINA                     |   1996 | 4663289900.33909
 CHINA                     |   1995 | 4683820892.29765
 CHINA                     |   1994 | 4678593059.26513
 CHINA                     |   1993 | 4646462968.92743
 CHINA                     |   1992 | 4660071427.49023
 EGYPT                     |   1998 | 2729280869.96416
 EGYPT                     |   1997 | 4647333932.35124
 EGYPT                     |   1996 | 4687216184.04477
 EGYPT                     |   1995 | 4671714906.46468
 EGYPT                     |   1994 | 4631546242.19453
 EGYPT                     |   1993 | 4655554860.37345
 EGYPT                     |   1992 | 4662882072.60466
 ETHIOPIA                  |   1998 | 2756760268.49739
 ETHIOPIA                  |   1997 | 4680795505.25763
 ETHIOPIA                  |   1996 | 4671633976.57582
 ETHIOPIA                  |   1995 | 4686958896.69777
 ETHIOPIA                  |   1994 | 4680150769.93293
 ETHIOPIA                  |   1993 | 4672615269.43528
 ETHIOPIA                  |   1992 |   4683010424.161
 FRANCE                    |   1998 |  2716867736.5709
 FRANCE                    |   1997 | 4678420055.98068
 FRANCE                    |   1996 | 4684978042.89457
 FRANCE                    |   1995 |  4668908913.3961
 FRANCE                    |   1994 | 4658338232.84646
 FRANCE                    |   1993 | 4669962035.62419
 FRANCE                    |   1992 | 4679795149.63328
 GERMANY                   |   1998 | 2731354099.65629
 GERMANY                   |   1997 | 4655695540.72876
 GERMANY                   |   1996 | 4650831958.85562
 GERMANY                   |   1995 | 4661430415.76237
 GERMANY                   |   1994 | 4661909505.78675
 GERMANY                   |   1993 | 4643497411.76756
 GERMANY                   |   1992 | 4676029971.34683
 INDIA                     |   1998 | 2715514205.45293
 INDIA                     |   1997 | 4647747813.50417
 INDIA                     |   1996 | 4665471231.31881
 INDIA                     |   1995 | 4632123896.02971
 INDIA                     |   1994 | 4618939191.53027
 INDIA                     |   1993 | 4639283722.42981
 INDIA                     |   1992 | 4652634692.29259
 INDONESIA                 |   1998 | 2734523522.15277
 INDONESIA                 |   1997 | 4632652643.35509
 INDONESIA                 |   1996 | 4645519892.24561
 INDONESIA                 |   1995 |  4631106976.1941
 INDONESIA                 |   1994 | 4639526221.58744
 INDONESIA                 |   1993 | 4641725698.96022
 INDONESIA                 |   1992 | 4645449255.36951
 IRAN                      |   1998 | 2704448144.23044
 IRAN                      |   1997 | 4626554746.59319
 IRAN                      |   1996 | 4646224855.44169
 IRAN                      |   1995 | 4630216843.78217
 IRAN                      |   1994 | 4648544142.80082
 IRAN                      |   1993 | 4630774402.60233
 IRAN                      |   1992 | 4675476949.43756
 IRAQ                      |   1998 | 2713066749.88435
 IRAQ                      |   1997 | 4642362152.75618
 IRAQ                      |   1996 | 4648006588.38673
 IRAQ                      |   1995 | 4652822201.81067
 IRAQ                      |   1994 | 4664916391.59621
 IRAQ                      |   1993 | 4635394940.67578
 IRAQ                      |   1992 | 4669329722.98685
 JAPAN                     |   1998 | 2718122124.87066
 JAPAN                     |   1997 | 4635482893.65567
 JAPAN                     |   1996 | 4659430533.32492
 JAPAN                     |   1995 | 4644168091.72465
 JAPAN                     |   1994 | 4659796984.91744
 JAPAN                     |   1993 | 4626609043.47585
 JAPAN                     |   1992 | 4651372122.27092
 JORDAN                    |   1998 | 2715373629.96424
 JORDAN                    |   1997 | 4643264359.60341
 JORDAN                    |   1996 | 4645666762.63903
 JORDAN                    |   1995 | 4622103710.40431
 JORDAN                    |   1994 | 4632338076.86245
 JORDAN                    |   1993 | 4645595227.74245
 JORDAN                    |   1992 |  4627138357.0927
 KENYA                     |   1998 | 2712923804.38938
 KENYA                     |   1997 | 4625974916.17218
 KENYA                     |   1996 | 4642233162.75874
 KENYA                     |   1995 | 4628107525.82574
 KENYA                     |   1994 |  4629244878.3793
 KENYA                     |   1993 | 4610555947.36702
 KENYA                     |   1992 | 4639102059.11183
 MOROCCO                   |   1998 | 2734669474.10605
 MOROCCO                   |   1997 | 4676450667.45907
 MOROCCO                   |   1996 | 4679448080.76375
 MOROCCO                   |   1995 |  4677415290.3988
 MOROCCO                   |   1994 | 4672717908.01999
 MOROCCO                   |   1993 | 4666313717.64468
 MOROCCO                   |   1992 | 4688436570.38289
 MOZAMBIQUE                |   1998 | 2715331688.97759
 MOZAMBIQUE                |   1997 |  4656648480.6468
 MOZAMBIQUE                |   1996 | 4688513781.48483
 MOZAMBIQUE                |   1995 | 4658118293.56324
 MOZAMBIQUE                |   1994 | 4656690452.68118
 MOZAMBIQUE                |   1993 | 4636583608.63569
 MOZAMBIQUE                |   1992 | 4658574899.13122
 PERU                      |   1998 | 2718269242.64655
 PERU                      |   1997 | 4633387033.16349
 PERU                      |   1996 | 4660507747.40937
 PERU                      |   1995 | 4617996232.19531
 PERU                      |   1994 | 4615876310.81976
 PERU                      |   1993 | 4645354883.75816
 PERU                      |   1992 | 4633419010.91708
 ROMANIA                   |   1998 | 2721482345.41679
 ROMANIA                   |   1997 |  4649478083.5922
 ROMANIA                   |   1996 | 4664923806.63519
 ROMANIA                   |   1995 | 4660397239.92745
 ROMANIA                   |   1994 | 4669230195.11221
 ROMANIA                   |   1993 | 4664474240.50415
 ROMANIA                   |   1992 | 4666099296.85072
 RUSSIA                    |   1998 | 2718834555.24024
 RUSSIA                    |   1997 | 4664300629.68942
 RUSSIA                    |   1996 | 4644956261.32636
 RUSSIA                    |   1995 | 4639684270.97634
 RUSSIA                    |   1994 | 4640824326.87794
 RUSSIA                    |   1993 | 4637642564.00873
 RUSSIA                    |   1992 | 4673456728.49895
 SAUDI ARABIA              |   1998 | 2702724568.49929
 SAUDI ARABIA              |   1997 |  4644548305.7556
 SAUDI ARABIA              |   1996 |  4664693840.0152
 SAUDI ARABIA              |   1995 | 4651921139.31494
 SAUDI ARABIA              |   1994 | 4652604888.41255
 SAUDI ARABIA              |   1993 | 4651418895.30494
 SAUDI ARABIA              |   1992 | 4659682197.57734
 UNITED KINGDOM            |   1998 | 2747110988.71265
 UNITED KINGDOM            |   1997 | 4690559585.84936
 UNITED KINGDOM            |   1996 | 4702507761.48554
 UNITED KINGDOM            |   1995 | 4687772802.50103
 UNITED KINGDOM            |   1994 | 4680052600.48285
 UNITED KINGDOM            |   1993 | 4671162810.57232
 UNITED KINGDOM            |   1992 | 4710831598.76778
 UNITED STATES             |   1998 | 2721948569.01271
 UNITED STATES             |   1997 | 4668599932.04316
 UNITED STATES             |   1996 | 4679538083.15354
 UNITED STATES             |   1995 | 4649610505.19258
 UNITED STATES             |   1994 | 4654264498.09669
 UNITED STATES             |   1993 | 4642302365.27889
 UNITED STATES             |   1992 |  4669403625.7447
 VIETNAM                   |   1998 | 2739414628.62033
 VIETNAM                   |   1997 | 4658696401.70072
 VIETNAM                   |   1996 | 4691832335.67848
 VIETNAM                   |   1995 | 4689695168.43357
 VIETNAM                   |   1994 | 4669941927.67704
 VIETNAM                   |   1993 | 4672789156.37259
 VIETNAM                   |   1992 | 4683236763.20238
(175 rows)

COMMIT;
COMMIT
