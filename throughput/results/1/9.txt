BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%olive%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 |  2729517129.4774
 ALGERIA                   |   1997 | 4677513451.98257
 ALGERIA                   |   1996 | 4682840199.90115
 ALGERIA                   |   1995 | 4664034259.05005
 ALGERIA                   |   1994 | 4664151103.18349
 ALGERIA                   |   1993 | 4633764642.31098
 ALGERIA                   |   1992 | 4666375916.72331
 ARGENTINA                 |   1998 | 2691480958.49534
 ARGENTINA                 |   1997 | 4641264043.25837
 ARGENTINA                 |   1996 |  4672040610.6545
 ARGENTINA                 |   1995 | 4635492259.73549
 ARGENTINA                 |   1994 | 4630487946.83574
 ARGENTINA                 |   1993 | 4627772173.24586
 ARGENTINA                 |   1992 | 4637300533.15594
 BRAZIL                    |   1998 | 2732501249.16595
 BRAZIL                    |   1997 | 4673022313.03876
 BRAZIL                    |   1996 |  4651042893.5584
 BRAZIL                    |   1995 | 4685462868.93005
 BRAZIL                    |   1994 | 4663185619.37904
 BRAZIL                    |   1993 | 4673814539.27309
 BRAZIL                    |   1992 | 4674446864.21088
 CANADA                    |   1998 | 2726046522.19909
 CANADA                    |   1997 | 4659419379.72482
 CANADA                    |   1996 | 4654100180.18235
 CANADA                    |   1995 | 4667585050.08369
 CANADA                    |   1994 | 4647604904.08755
 CANADA                    |   1993 | 4658119996.54438
 CANADA                    |   1992 | 4680585379.71688
 CHINA                     |   1998 |   2714246449.749
 CHINA                     |   1997 | 4654555486.41034
 CHINA                     |   1996 | 4658092233.75784
 CHINA                     |   1995 | 4658992965.47488
 CHINA                     |   1994 | 4621901084.07056
 CHINA                     |   1993 | 4661453531.65244
 CHINA                     |   1992 | 4657725326.07309
 EGYPT                     |   1998 | 2728564570.24008
 EGYPT                     |   1997 | 4659316229.34948
 EGYPT                     |   1996 | 4668314963.05134
 EGYPT                     |   1995 | 4665069453.94858
 EGYPT                     |   1994 | 4673926906.37868
 EGYPT                     |   1993 | 4675619206.80602
 EGYPT                     |   1992 | 4683711239.46774
 ETHIOPIA                  |   1998 | 2748846545.31846
 ETHIOPIA                  |   1997 | 4674364200.96653
 ETHIOPIA                  |   1996 | 4668477187.41359
 ETHIOPIA                  |   1995 | 4678475469.59867
 ETHIOPIA                  |   1994 | 4690980704.27288
 ETHIOPIA                  |   1993 | 4685764785.98515
 ETHIOPIA                  |   1992 |  4684594174.2849
 FRANCE                    |   1998 | 2747779354.23665
 FRANCE                    |   1997 | 4671604234.76304
 FRANCE                    |   1996 | 4688068399.96739
 FRANCE                    |   1995 |   4686473598.618
 FRANCE                    |   1994 |   4678946224.578
 FRANCE                    |   1993 | 4693646218.11585
 FRANCE                    |   1992 | 4684548282.08435
 GERMANY                   |   1998 | 2741887626.27874
 GERMANY                   |   1997 | 4674393749.97858
 GERMANY                   |   1996 | 4702272911.77872
 GERMANY                   |   1995 | 4696771696.59777
 GERMANY                   |   1994 | 4654777434.04327
 GERMANY                   |   1993 | 4703255190.69086
 GERMANY                   |   1992 | 4716071968.29455
 INDIA                     |   1998 | 2746107023.21715
 INDIA                     |   1997 | 4678378508.66556
 INDIA                     |   1996 | 4683868153.26188
 INDIA                     |   1995 | 4677017102.68674
 INDIA                     |   1994 | 4663294679.23729
 INDIA                     |   1993 | 4674261444.17023
 INDIA                     |   1992 |  4672468437.6181
 INDONESIA                 |   1998 | 2704854203.72763
 INDONESIA                 |   1997 | 4639609837.05586
 INDONESIA                 |   1996 | 4626207423.28106
 INDONESIA                 |   1995 |  4613264969.4798
 INDONESIA                 |   1994 | 4643922259.05581
 INDONESIA                 |   1993 | 4608612190.39586
 INDONESIA                 |   1992 | 4638512066.15971
 IRAN                      |   1998 |  2720758074.9584
 IRAN                      |   1997 | 4664007830.74768
 IRAN                      |   1996 | 4661864218.46805
 IRAN                      |   1995 | 4640232088.76482
 IRAN                      |   1994 | 4663278784.08253
 IRAN                      |   1993 | 4653244336.44523
 IRAN                      |   1992 | 4685022893.25761
 IRAQ                      |   1998 | 2724128052.62153
 IRAQ                      |   1997 | 4647014361.82283
 IRAQ                      |   1996 | 4686513270.04437
 IRAQ                      |   1995 | 4682059369.67752
 IRAQ                      |   1994 | 4679996340.58149
 IRAQ                      |   1993 | 4652550545.73098
 IRAQ                      |   1992 | 4672920539.07538
 JAPAN                     |   1998 | 2715202126.33908
 JAPAN                     |   1997 | 4638680208.27803
 JAPAN                     |   1996 | 4672977566.80849
 JAPAN                     |   1995 | 4664955525.79102
 JAPAN                     |   1994 | 4634814138.12988
 JAPAN                     |   1993 | 4626472821.55923
 JAPAN                     |   1992 | 4633560803.55238
 JORDAN                    |   1998 | 2708722051.94476
 JORDAN                    |   1997 | 4609758797.41453
 JORDAN                    |   1996 |  4636073056.0282
 JORDAN                    |   1995 | 4623924984.05582
 JORDAN                    |   1994 | 4649773362.28801
 JORDAN                    |   1993 |  4642392775.4227
 JORDAN                    |   1992 | 4665962987.54515
 KENYA                     |   1998 | 2709932037.33295
 KENYA                     |   1997 |  4623776081.4919
 KENYA                     |   1996 | 4655045780.82512
 KENYA                     |   1995 | 4629258527.73244
 KENYA                     |   1994 | 4637215299.35476
 KENYA                     |   1993 | 4630006087.66117
 KENYA                     |   1992 | 4643918707.46036
 MOROCCO                   |   1998 | 2740414994.93403
 MOROCCO                   |   1997 | 4713942598.29479
 MOROCCO                   |   1996 | 4693786349.03088
 MOROCCO                   |   1995 | 4661210598.66845
 MOROCCO                   |   1994 | 4679915353.25973
 MOROCCO                   |   1993 | 4679401149.10935
 MOROCCO                   |   1992 |  4674421078.1191
 MOZAMBIQUE                |   1998 | 2735745851.27904
 MOZAMBIQUE                |   1997 | 4683866301.67743
 MOZAMBIQUE                |   1996 | 4674090041.37316
 MOZAMBIQUE                |   1995 | 4675825130.00842
 MOZAMBIQUE                |   1994 | 4656877202.67661
 MOZAMBIQUE                |   1993 | 4660375452.51253
 MOZAMBIQUE                |   1992 | 4658823877.31735
 PERU                      |   1998 | 2699692545.95017
 PERU                      |   1997 | 4636939533.46506
 PERU                      |   1996 | 4671151137.88062
 PERU                      |   1995 | 4628648941.28729
 PERU                      |   1994 | 4637484063.67733
 PERU                      |   1993 | 4612730439.60445
 PERU                      |   1992 |  4644434531.0076
 ROMANIA                   |   1998 | 2746430478.30308
 ROMANIA                   |   1997 | 4673187435.54956
 ROMANIA                   |   1996 | 4690716169.54393
 ROMANIA                   |   1995 | 4677964262.73894
 ROMANIA                   |   1994 | 4673476934.90885
 ROMANIA                   |   1993 | 4663333125.64872
 ROMANIA                   |   1992 | 4685832863.82224
 RUSSIA                    |   1998 | 2711486339.72245
 RUSSIA                    |   1997 | 4624466448.75722
 RUSSIA                    |   1996 | 4636905735.43777
 RUSSIA                    |   1995 | 4639049995.36426
 RUSSIA                    |   1994 | 4653462623.39569
 RUSSIA                    |   1993 |  4649323042.9141
 RUSSIA                    |   1992 | 4631393264.38652
 SAUDI ARABIA              |   1998 | 2711487705.20488
 SAUDI ARABIA              |   1997 | 4661750570.24369
 SAUDI ARABIA              |   1996 | 4661213048.98973
 SAUDI ARABIA              |   1995 | 4662147329.32185
 SAUDI ARABIA              |   1994 | 4650535881.96294
 SAUDI ARABIA              |   1993 | 4641238435.48473
 SAUDI ARABIA              |   1992 | 4646594293.24755
 UNITED KINGDOM            |   1998 |  2770989934.7867
 UNITED KINGDOM            |   1997 | 4764571507.72629
 UNITED KINGDOM            |   1996 | 4729759561.13989
 UNITED KINGDOM            |   1995 | 4725381189.15427
 UNITED KINGDOM            |   1994 | 4707141705.60599
 UNITED KINGDOM            |   1993 | 4703642260.01836
 UNITED KINGDOM            |   1992 | 4740656077.09605
 UNITED STATES             |   1998 | 2741623664.91657
 UNITED STATES             |   1997 | 4675507426.62334
 UNITED STATES             |   1996 | 4666579842.33908
 UNITED STATES             |   1995 | 4652931829.45532
 UNITED STATES             |   1994 | 4644605951.65427
 UNITED STATES             |   1993 | 4686430546.63688
 UNITED STATES             |   1992 |  4680783332.5051
 VIETNAM                   |   1998 | 2736292893.87758
 VIETNAM                   |   1997 | 4689786077.38085
 VIETNAM                   |   1996 | 4710946303.92939
 VIETNAM                   |   1995 | 4693861264.24215
 VIETNAM                   |   1994 | 4693206102.51445
 VIETNAM                   |   1993 | 4701098247.59306
 VIETNAM                   |   1992 | 4692208863.86923
(175 rows)

COMMIT;
COMMIT
